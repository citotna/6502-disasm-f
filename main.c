#include <stdio.h>
#include <stdint.h>
const char ops[][3]={"RRA","SEI","BIT","SBC","BVC","RTS","LXA","DEC","BVS","BCS","PLA","PLP","BEQ","LSR","ASR","SHA","PHA","ROL","LDY","ORA","STY","CLC","INY","CPX","RTI","TXS","BCC","EOR","AND","TSX","DEY","SHS","SBX","RLA","SEC","STA","ARR","CLV","JSR","SHX","BPL","NOP","SAX","TAY","ADC","LDX","PHP","ISC","TAX","STX","CMP","SED","TXA","XAA","LDA","ANC","DCP","ASL","BRK","SRE","DEX","JMP","TYA","CLD","CPY","INC","LAS","LAX","JAM","INX","SLO","BNE","CLI","ROR","SHY","BMI"};
const uint8_t opi[256]={ 58,19,68,70,41,19,57,70,46,19,57,55,41,19,57,70,40,19,68,70,41,19,57,70,21,19,41,70,41,19,57,70,38,28,68,33,2,28,17,33,11,28,17,55,2,28,17,33,75,28,68,33,41,28,17,33,34,28,41,33,41,28,17,33,24,27,68,59,41,27,13,59,16,27,13,14,61,27,13,59,4,27,68,59,41,27,13,59,72,27,41,59,41,27,13,59,5,44,68,0,41,44,73,0,10,44,73,36,61,44,73,0,8,44,68,0,41,44,73,0,1,44,41,0,41,44,73,0,41,35,41,42,20,35,49,42,30,41,52,53,20,35,49,42,26,35,68,15,20,35,49,42,62,35,25,31,74,35,39,15,18,54,45,67,18,54,45,67,43,54,48,6,18,54,45,67,9,54,68,67,18,54,45,67,37,54,29,66,18,54,45,67,64,50,41,56,64,50,7,56,22,50,60,32,64,50,7,56,71,50,68,56,41,50,7,56,63,50,41,56,41,50,7,56,23,3,41,47,23,3,65,47,69,3,41,3,23,3,65,47,12,3,68,47,41,3,65,47,51,3,41,47,41,3,65,47};
const uint8_t am[256]={ 6,8,0,8,11,11,11,11,6,5,1,5,2,2,2,2,10,9,0,9,12,12,12,12,6,4,6,4,3,3,3,3,2,8,0,8,11,11,11,11,6,5,1,5,2,2,2,2,10,9,0,9,12,12,12,12,6,4,6,4,3,3,3,3,6,8,0,8,11,11,11,11,6,5,1,5,2,2,2,2,10,9,0,9,12,12,12,12,6,4,6,4,3,3,3,3,6,8,0,8,11,11,11,11,6,5,1,5,7,2,2,2,10,9,0,9,12,12,12,12,6,4,6,4,3,3,3,3,5,8,5,8,11,11,11,11,6,5,6,5,2,2,2,2,10,9,0,9,12,12,13,13,6,4,6,4,3,3,4,4,5,8,5,8,11,11,11,11,6,5,6,5,2,2,2,2,10,9,0,9,12,12,13,13,6,4,6,4,3,3,4,4,5,8,5,8,11,11,11,11,6,5,6,5,2,2,2,2,10,9,0,9,12,12,12,12,6,4,6,4,3,3,3,3,5,8,5,8,11,11,11,11,6,5,6,5,2,2,2,2,10,9,0,9,12,12,12,12,6,4,6,4,3,3,3,3 };
#define PB2(_C,_S) case _C:printf(_S,c[2],c[1]);c+=2;break;
#define PB1(_C,_S) case _C:printf(_S,c[1]);c+=1;break;
void print(uint8_t *c,size_t l,uint16_t b) {
    for(uint8_t *e=c+l,*s=c; c<e; ++c) { 
        uint16_t d=b+c-s; printf("%04X: %02X ",d,*c);
        switch((89491104>>(am[*c]*2))&3) {
	    case 0: printf("        %.3s",ops[opi[*c]]); break;
	    case 2:	printf("%02X %02X   %.3s ",c[1],c[2],ops[opi[*c]]);
	        switch(am[*c]) {
		    PB2(2,"$%02X%02X");     PB2(3,"$%02X%02X,Y");
		    PB2(4,"$%02X%02X,X");   PB2(7,"($%02X%02X)"); } break;
	    case 1: printf("%02X      %.3s ",c[1],ops[opi[*c]]); 
	        switch(am[*c]) {
		    case 10: printf("$%04X",(uint16_t)(d+(int8_t)c[1])+2); c++; break;
    		PB1(8,"($%02X,X)");     PB1(9,"($%02X),Y");
    		PB1(5,"#$%02X");        PB1(11,"$%02X");
    		PB1(12,"$%02X,X");      PB1(13,"$%02X,Y"); } break;
		} putchar('\n');
	} return;
}
int main() { /*test*/ uint8_t code[] = {0xA5,0x1F,0xC9,0x01,0xF0,0x01,0x60,0xA9,0x00,0x85,0x0C,0xA9,0x78,0x85,0x0D,0xA9,0x00,0x85,0x6D,0xA0,0x00,0xB1,0x0C,0x85,0x6E,0x29,0x1F,0xC9,0x05,0xD0,0x40,0xA5,0x6E,0x29,0xE0,0x85,0x6E,0xA6,0x6D,0xE8,0xE4,0x0F,0x90,0x08,0xA5,0x20,0xC9,0x05,0xD0,0x27,0xF0,0x2B,0xA5,0x0C,0x18,0x65,0x0E,0x85,0x72,0xA5,0x0D,0x69,0x00,0x85,0x73,0xB1,0x72,0x85,0x6F,0x29,0xE0,0xC5,0x6E,0xF0,0x02,0x10,0x12,0xA5,0x6F,0x29,0x1F,0xC9,0x05,0xF0,0x0A,0xC9,0x07,0xF0,0x06,0xA9,0x07,0x05,0x6E,0x91,0x0C,0xC8,0xC4,0x0E,0x90,0xB1,0xA5,0x0C,0x18,0x65,0x0E,0x85,0x0C,0x90,0x02,0xE6,0x0D,0xE6,0x6D,0xA5,0x6D,0xC5,0x0F,0x90,0x9C,0x60};
	print(code,sizeof(code),0xabc9);
    return 1;
}
